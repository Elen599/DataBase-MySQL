/* –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ SQL –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü
    –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–±–ª–∏—Ü–∞ ‚Äú–§–∏–ª—å–º—ã‚Äù –∏ —Ç–∞–±–ª–∏—Ü–∞ ‚Äú–ö–∏–Ω–æ—Å—Ç—É–¥–∏–∏‚Äù.
    –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏.

    –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏:
    –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü\–ø–æ–ª–µ–π, 
    –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü\–ø–æ–ª–µ–π;
    –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–µ–π(–≤–Ω–µ—à–Ω–∏—Ö);
    –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞;
    –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º CASE;
    –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º IF.

    –ü–æ–¥—É–º–∞—Ç—å –∏ –æ–ø–∏—Å–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö;

    –û—Ñ–æ—Ä–º–∏—Ç—å —Ä–∞–±–æ—Ç—É —Ç–∞–∫, —á—Ç–æ–±—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –±—ã–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —É–¥–æ–±–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ª–∏—á–Ω–æ –≤–∞–º.
*/

-- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã
create schema KinoFinder;

-- –í—ã–±–∏—Ä–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
use kinofinder;

 -- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (—É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏)
create table Film
( 
id int not null auto_increment primary key,
title varchar(45),
year int,
ganre varchar(45)
);

-- –ó–∞–ø—Ä–æ—Å –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —ç–∫—Ä–∞–Ω
select * from Film;

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã "–§–∏–ª—å–º"
INSERT Film (title, year, ganre)
VALUES
    ('–¢—Ä–µ–º–±–∏—Ç—Ç–∞',1958,'–ö–æ–º–µ–¥–∏—è'),
    ('–ú–∞—Ä–≤–µ–ª', 2010, '–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞'), 
    ('–ß–µ–±—É—Ä–∞—à–∫–∞', 2022, '–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞'),
    ('–ú–∞—Ä–≤–µ–ª', 2010, "–ë–æ–µ–≤–∏–∫"),
    ('–í–µ—Ç—Ä–µ–Ω–Ω—ã–π', 1998, "–ú–µ–ª–æ–¥—Ä–∞–º–∞");
    
-- –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —ç–∫—Ä–∞–Ω
SELECT * FROM Film;


-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (—É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏)
create table Studia
( 
id int not null auto_increment primary key,
title varchar(45),
founders varchar(45)
);

-- –ó–∞–ø—Ä–æ—Å –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —ç–∫—Ä–∞–Ω
select * from Studia;

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã "–§–∏–ª—å–º"
INSERT Studia (title, founders)
VALUES
    ('–õ–µ–Ω—Ñ–∏–ª—å–º', '–°–°–°–†'),
    ('–ú–∞—Ä–≤–µ–ª', '–î–∏—Å–Ω–µ–π'), 
    ('–°–æ—é–∑–º—É–ª—å—Ç—Ñ–∏–ª—å–º','–¶–µ–Ω—Ç—Ä–∞–ª –ü–∞—Ä—Ç–Ω–µ—Ä—à–∏–ø'),
    ('–ú–∞—Ä–≤–µ–ª', '–î–∏—Å–Ω–µ–π'),
    ('Mia', 'Paramount Pictures');
    
-- –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —ç–∫—Ä–∞–Ω
SELECT * FROM Studia;  
drop table Studia;

-- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –§–∏–ª—å–º —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã RENAME TABLE
RENAME TABLE film TO kinofilm;
SELECT * FROM kinofilm;

RENAME TABLE kinofilm TO film;
SELECT * FROM film;

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ Film  —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã ADD
ALTER TABLE film
    ADD rating INT NULL;
SELECT * FROM film;   

-- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Film  
ALTER TABLE film
DROP COLUMN rating;


/* 
–í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏. –°–≤—è–∑—å –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–π:
–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã  distribution 
 */
CREATE TABLE  distribution  
(
    studio_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    studio_title VARCHAR(100)
);

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã distribution 
INSERT distribution(studio_title)
VALUES 
    ('–õ–µ–Ω—Ñ–∏–ª—å–º'),
    ('–ú–∞—Ä–≤–µ–ª'), 
    ('–°–æ—é–∑–º—É–ª—å—Ç—Ñ–∏–ª—å–º'), 
    ('Paramount Pictures');
    
SELECT * FROM distribution;   

-- 3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –≤ —Ç–∞–±–ª–∏—Ü—É Film
ALTER TABLE film
    ADD founder varchar(45) NOT NULL DEFAULT 1;

SELECT * FROM film;    


-- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ Film —Å –ø–æ–º–æ—â—å—é –ü–°–ï–í–î–û–ù–ò–ú–ê:
SELECT 
    id as '‚Ññ',
    title as '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ',
    year as '–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è',
    ganre as '–ñ–∞–Ω—Ä'
FROM Film;
SELECT * FROM film;


-- –î–æ–±–∞–≤–ª–∏–µ (—Å–ª–∏—è–Ω–∏–µ) 2—Ö —Ç–∞–±–ª–∏—Ü: —Å–ª–µ–≤–∞ - film, —Å–ø—Ä–∞–≤–∞ - studia (distribution):
-- ADD FOREIGN KEY ()

SELECT * FROM film LEFT JOIN distribution
ON film.founder = distribution.studio_id;

-- –°–≤—è–∑—å —Ç–∞–±–ª–∏—Ü –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞
ALTER TABLE distribution
    ADD FOREIGN KEY (studio_id)  REFERENCES film(id);
SELECT * FROM film; 


/* –û–ø–µ—Ä–∞—Ç–æ—Ä CASE –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å—Ç–∏–Ω–Ω–æ—Å—Ç—å –Ω–∞–±–æ—Ä–∞ —É—Å–ª–æ–≤–∏–π 
   –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
CASE
    WHEN —É—Å–ª–æ–≤–∏–µ_1 THEN —Ä–µ–∑—É–ª—å—Ç–∞—Ç_1
    WHEN —É—Å–ª–æ–≤–∏–µ_2 THEN —Ä–µ–∑—É–ª—å—Ç–∞—Ç_2
    .................................
    WHEN —É—Å–ª–æ–≤–∏–µ_N THEN —É—Å–ª–æ–≤–∏–µ_N
    [ELSE –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π_—Ä–µ–∑—É–ª—å—Ç–∞—Ç]
END
*/
SELECT * FROM film; 

ALTER TABLE film
    ADD rating INT NULL;
SELECT * FROM film;  

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ "–†–µ–π—Ç–∏–Ω–≥"
insert into Film (rating)
values 
	('5'),
    ('4'),
    ('5'),
    ('3'),
    ('1');
select * from Film; 
/* 
INSERT INTO –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—É SQL, –∞ —Ç–æ—á–Ω–µ–µ, –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫.
    INSERT INTO –ò–ú–Ø_–¢–ê–ë–õ–ò–¶–´ (—Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2, —Å—Ç–æ–ª–±–µ—Ü3,... —Å—Ç–æ–ª–±–µ—Ü N)  
    VALUES (–∑–Ω–∞—á–µ–Ω–∏–µ1, –∑–Ω–∞—á–µ–Ω–∏–µ2, –∑–Ω–∞—á–µ–Ω–∏–µ3,... –∑–Ω–∞—á–µ–Ω–∏–µ N);
–ó–¥–µ—Å—å —Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2, —Å—Ç–æ–ª–±–µ—Ü3,‚Ä¶ —Å—Ç–æ–ª–±–µ—Ü N ‚Äî —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ, –≤ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. 
–í—ã –º–æ–∂–µ—Ç–µ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ –≤ SQL-–∑–∞–ø—Ä–æ—Å–µ, –µ—Å–ª–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã. 
–ù–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Ä—è–¥–∫—É —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ.

–ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é select –¥–ª—è –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü—ã; 
–µ—Å–ª–∏ –≤ –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤ –ø–µ—Ä–≤–æ–π:
INSERT INTO –∏–º—è_–ø–µ—Ä–≤–æ–π_—Ç–∞–±–ª–∏—Ü—ã [(—Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2,... —Å—Ç–æ–ª–±–µ—Ü N)] 
   SELECT —Å—Ç–æ–ª–±–µ—Ü1, —Å—Ç–æ–ª–±–µ—Ü2,... —Å—Ç–æ–ª–±–µ—Ü N
   FROM –∏–º—è_–≤—Ç–æ—Ä–æ–π_—Ç–∞–±–ª–∏—Ü—ã
   [WHERE —É—Å–ª–æ–≤–∏–µ];
*/ 


SELECT 
    title as '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ',
    CASE rating
        WHEN 1 THEN 'üëç'
        WHEN 2 THEN 'üëçüëç'
        WHEN 3 THEN 'üëçüëçüëç'    
        WHEN 4 THEN 'üëçüëçüëçüëç'
        WHEN 5 THEN 'üëçüëçüëçüëçüëç'
        ELSE 'üëçüëçüëçüëçüëç'
    END AS '–†–µ–π—Ç–∏–Ω–≥'
FROM film;

/* –§—É–Ω–∫—Ü–∏—è IF –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —É—Å–ª–æ–≤–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ –∏–∑ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
   IF(—É—Å–ª–æ–≤–∏–µ, –∑–Ω–∞—á–µ–Ω–∏–µ_1, –∑–Ω–∞—á–µ–Ω–∏–µ_2)
*/
SELECT 
  title as '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ',
  IF (rating >= 3, '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π','–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π') AS '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è'
FROM film;


--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
/*
–ß–∞—Å—Ç–æ –µ—Å—Ç—å —Å–º—ã—Å–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ UPDATE, –Ω–∞–ø—Ä–∏–º–µ—Ä: "updated_at DATETIME ON UPDATE now()".
–•–æ—Ä–æ—à–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (DEFAULT). –≠—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ë–î –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º.
–ü—Ä–∞–≤–∏–ª—å–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–∞–∫–µ—Ç–Ω—É—é –≤—Å—Ç–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö (–æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫).
*/